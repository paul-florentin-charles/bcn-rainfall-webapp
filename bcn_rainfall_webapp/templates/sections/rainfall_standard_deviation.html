{% extends "layout.html" %}

{% block body %}

<div class="pure-g">
    <div id="first-button-group" class="pure-u-1 pure-u-lg-1-4 flex-center">
        <div class="pure-button-group" role="group" aria-label="...">
            <button class="pure-button pure-button-primary" onclick="sortAscending();">Sort ascending</button>
            <button class="pure-button pure-button-primary" onclick="sortDescending();">Sort descending</button>
            <button class="pure-button" onclick="resetGraph();">Reset</button>
        </div>
    </div>
    <div id="first-plotly-graph" class="pure-u-1 pure-u-lg-3-4 flex-center">
        <div class="plotly-graph" id="chart_rainfall_standard_deviation"></div>
    </div>
</div>

<div class="pure-g">
    <div class="pure-u-1 pure-u-lg-3-4 flex-center">
        <div class="plotly-graph" id="chart_rainfall_standard_deviation_weighted"></div>
    </div>
    <div class="pure-u-1 pure-u-lg-1-4 flex-center">
        <div class="pure-button-group" role="group" aria-label="...">
            <button class="pure-button pure-button-primary" onclick="sortAscendingWeighted();">Sort ascending</button>
            <button class="pure-button pure-button-primary" onclick="sortDescendingWeighted();">Sort descending</button>
            <button class="pure-button" onclick="resetGraphWeighted();">Reset</button>
        </div>
    </div>
</div>

{% endblock %}

{% block scripts %}

<script type='text/javascript'>
    const graph_rainfall_standard_deviation = {{ plotlyRainfallStandardDeviationJSON|safe }}
    const graph_rainfall_standard_deviation_weighted = {{ plotlyRainfallStandardDeviationWeightedJSON|safe }}

    const graph_div_id_to_graph_json = {
        chart_rainfall_standard_deviation: graph_rainfall_standard_deviation,
        chart_rainfall_standard_deviation_weighted: graph_rainfall_standard_deviation_weighted,
    };

    ['load', 'resize'].forEach(event => window.addEventListener(event, function () {
        if (window.screen.width < 768) {
            Object.values(graph_div_id_to_graph_json).forEach((graph_json) => {
                graph_json.layout.font.size = 9;
                graph_json.layout.margin = {"t": 65, "r": 15, "b": 25, "l": 25};
                document.getElementById("first-plotly-graph").insertAdjacentElement('afterend', document.getElementById("first-button-group"));
            })
        } else {
            Object.values(graph_div_id_to_graph_json).forEach((graph_json) => {
                graph_json.layout.font.size = 11;
                graph_json.layout.margin = {"t": 65, "r": 30, "b": 45, "l": 65};
                document.getElementById("first-plotly-graph").insertAdjacentElement('beforebegin', document.getElementById("first-button-group"));
            })
        }

        Object.entries(graph_div_id_to_graph_json).forEach(([graph_div_id, graph_json]) => {
            Plotly.react(graph_div_id, graph_json, {}, config);
        })
    }))

    function sortAscending() {
        graph_rainfall_standard_deviation.layout.xaxis.categoryorder = "total ascending";
        Plotly.react(chart_rainfall_standard_deviation, graph_rainfall_standard_deviation, {}, config);
    }

    function sortAscendingWeighted() {
        graph_rainfall_standard_deviation_weighted.layout.xaxis.categoryorder = "total ascending";
        Plotly.react(chart_rainfall_standard_deviation_weighted, graph_rainfall_standard_deviation_weighted, {}, config);
    }

    function sortDescending() {
        graph_rainfall_standard_deviation.layout.xaxis.categoryorder = "total descending";
        Plotly.react(chart_rainfall_standard_deviation, graph_rainfall_standard_deviation, {}, config);
    }

    function sortDescendingWeighted() {
        graph_rainfall_standard_deviation_weighted.layout.xaxis.categoryorder = "total descending";
        Plotly.react(chart_rainfall_standard_deviation_weighted, graph_rainfall_standard_deviation_weighted, {}, config);
    }

    function resetGraph() {
        graph_rainfall_standard_deviation.layout.xaxis.categoryorder = "total";
        Plotly.react(chart_rainfall_standard_deviation, graph_rainfall_standard_deviation, {}, config);
    }

    function resetGraphWeighted() {
        graph_rainfall_standard_deviation_weighted.layout.xaxis.categoryorder = "total";
        Plotly.react(chart_rainfall_standard_deviation_weighted, graph_rainfall_standard_deviation_weighted, {}, config);
    }

</script>

{% endblock %}